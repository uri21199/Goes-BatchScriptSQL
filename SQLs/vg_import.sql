
DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg0.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha0.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg2.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha2.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg3.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha3.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg4.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha4.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg5.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha5.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg6.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha6.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg7.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha7.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg8.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha8.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg9.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha9.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg10.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha10.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg11.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha11.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg12.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha12.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg13.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha13.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg14.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha14.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg15.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha15.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg16.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha16.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg17.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha17.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg18.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha18.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg19.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha19.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg20.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha20.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg21.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha21.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg22.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha22.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg23.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha23.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg24.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha24.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg25.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha25.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg26.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha26.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg27.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha27.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg28.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha28.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg29.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha29.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg30.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha30.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg31.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha31.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg32.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha32.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg33.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha33.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg34.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha34.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg35.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha35.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg36.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha36.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg37.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha37.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg38.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha38.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg39.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha39.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg40.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha40.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg41.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha41.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg42.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha42.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg43.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha43.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg44.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha44.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg45.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha45.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg46.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha46.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg47.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha47.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg48.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha48.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg49.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha49.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg50.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha50.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg51.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha51.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg52.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha52.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg53.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha53.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg54.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha54.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg55.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha55.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg56.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha56.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg57.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha57.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg58.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha58.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg59.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha59.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg60.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha60.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg61.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha61.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg62.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha62.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg63.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha63.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg64.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha64.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg65.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha65.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg66.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha66.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg67.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha67.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg68.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha68.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg69.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha69.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg70.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha70.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg71.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha71.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg72.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha72.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg73.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha73.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg74.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha74.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg75.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha75.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg76.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha76.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg77.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha77.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg78.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha78.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg79.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha79.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg80.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha80.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg81.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha81.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg82.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha82.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg83.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha83.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg84.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha84.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg85.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha85.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg86.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha86.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg87.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha87.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg88.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha88.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg89.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha89.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg90.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha90.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg91.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha91.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg92.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha92.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg93.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha93.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg94.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha94.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg95.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha95.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg96.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha96.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg97.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha97.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg98.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha98.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg99.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha99.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg100.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha100.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg101.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha101.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg102.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha102.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg103.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha103.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg104.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha104.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg105.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha105.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg106.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha106.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg107.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha107.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg108.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha108.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg109.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha109.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg110.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha110.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg111.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha111.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg112.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha112.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg113.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha113.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg114.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha114.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg115.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha115.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg116.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha116.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg117.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha117.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg118.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha118.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg119.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha119.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg120.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha120.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg121.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha121.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg122.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha122.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg123.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha123.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg124.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha124.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg125.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha125.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg126.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha126.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg127.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha127.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg128.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha128.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg129.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha129.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg130.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha130.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg131.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha131.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg132.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha132.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg133.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha133.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg134.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha134.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg135.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha135.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg136.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha136.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg137.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha137.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg138.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha138.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg139.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha139.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg140.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha140.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg141.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha141.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg142.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha142.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg143.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha143.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg144.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha144.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg145.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha145.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg146.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha146.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg147.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha147.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg148.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha148.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg149.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha149.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg150.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha150.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg151.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha151.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg152.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha152.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg153.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha153.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg154.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha154.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg155.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha155.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg156.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha156.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg157.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha157.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg158.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha158.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg159.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha159.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg160.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha160.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg161.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha161.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg162.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha162.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg163.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha163.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg164.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha164.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg165.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha165.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg166.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha166.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg167.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha167.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg168.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha168.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg169.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha169.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg170.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha170.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg171.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha171.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg172.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha172.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg173.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha173.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg174.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha174.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg175.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha175.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg176.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha176.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg177.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha177.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg178.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha178.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg179.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha179.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg180.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha180.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg181.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha181.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg182.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha182.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg183.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha183.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg184.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha184.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg185.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha185.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg186.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha186.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg187.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha187.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg188.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha188.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg189.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha189.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg190.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha190.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg191.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha191.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg192.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha192.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg193.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha193.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg194.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha194.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg195.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha195.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg196.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha196.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg197.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha197.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg198.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha198.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg199.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha199.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg200.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha200.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg201.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha201.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg202.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha202.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg203.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha203.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg204.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha204.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg205.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha205.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg206.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha206.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg207.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha207.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg208.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha208.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg209.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha209.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg210.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha210.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg211.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha211.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg212.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha212.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg213.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha213.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg214.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha214.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg215.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha215.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg216.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha216.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg217.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha217.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg218.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha218.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg219.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha219.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg220.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha220.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg221.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha221.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg222.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha222.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg223.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha223.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg224.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha224.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg225.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha225.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg226.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha226.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg227.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha227.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg228.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha228.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg229.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha229.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg230.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha230.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg231.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha231.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg232.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha232.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg233.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha233.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg234.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha234.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg235.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha235.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg236.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha236.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg237.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha237.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg238.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha238.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg239.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha239.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg240.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha240.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg241.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha241.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg242.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha242.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg243.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha243.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg244.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha244.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg245.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha245.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg246.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha246.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg247.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha247.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg248.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha248.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg249.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha249.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg250.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha250.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg251.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha251.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg252.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha252.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg253.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha253.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg254.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha254.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg255.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha255.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg256.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha256.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg257.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha257.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg258.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha258.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg259.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha259.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg260.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha260.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg261.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha261.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg262.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha262.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg263.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha263.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg264.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha264.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg265.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha265.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg266.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha266.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg267.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha267.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg268.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha268.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg269.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha269.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg270.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha270.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg271.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha271.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg272.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha272.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg273.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha273.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg274.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha274.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg275.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha275.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg276.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha276.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg277.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha277.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg278.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha278.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg279.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha279.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg280.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha280.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg281.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha281.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg282.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha282.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg283.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha283.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg284.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha284.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg285.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha285.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg286.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha286.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg287.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha287.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg288.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha288.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg289.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha289.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg290.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha290.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg291.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha291.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg292.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha292.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg293.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha293.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg294.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha294.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg295.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha295.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg296.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha296.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg297.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha297.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg298.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha298.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg299.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha299.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg300.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha300.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg301.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha301.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg302.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha302.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg303.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha303.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg304.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha304.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg305.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha305.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg306.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha306.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg307.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha307.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg308.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha308.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg309.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha309.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg310.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha310.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg311.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha311.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg312.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha312.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg313.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha313.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg314.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha314.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg315.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha315.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg316.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha316.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg317.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha317.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg318.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha318.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg319.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha319.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg320.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha320.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg321.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha321.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg322.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha322.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg323.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha323.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg324.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha324.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg325.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha325.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg326.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha326.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg327.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha327.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg328.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha328.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg329.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha329.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg330.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha330.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg331.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha331.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg332.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha332.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg333.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha333.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg334.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha334.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg335.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha335.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg336.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha336.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg337.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha337.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg338.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha338.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg339.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha339.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg340.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha340.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg341.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha341.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg342.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha342.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg343.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha343.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg344.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha344.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg345.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha345.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg346.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha346.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg347.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha347.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg348.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha348.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg349.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha349.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg350.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha350.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg351.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha351.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg352.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha352.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg353.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha353.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg354.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha354.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg355.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha355.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg356.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha356.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg357.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha357.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg358.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha358.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg359.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha359.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg360.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha360.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg361.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha361.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg362.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha362.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg363.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha363.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg364.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha364.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg365.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha365.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg366.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha366.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg367.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha367.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg368.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha368.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg369.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha369.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg370.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha370.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg371.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha371.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg372.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha372.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg373.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha373.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg374.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha374.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg375.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha375.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg376.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha376.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg377.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha377.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg378.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha378.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg379.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha379.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg380.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha380.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg381.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha381.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg382.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha382.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg383.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha383.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg384.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha384.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg385.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha385.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg386.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha386.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg387.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha387.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg388.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha388.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg389.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha389.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg390.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha390.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg391.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha391.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg392.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha392.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg393.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha393.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg394.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha394.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg395.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha395.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg396.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha396.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg397.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha397.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg398.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha398.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg399.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha399.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg400.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha400.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg401.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha401.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg402.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha402.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg403.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha403.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg404.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha404.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg405.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha405.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg406.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha406.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg407.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha407.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg408.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha408.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg409.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha409.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg410.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha410.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg411.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha411.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg412.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha412.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg413.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha413.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg414.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha414.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg415.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha415.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg416.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha416.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg417.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha417.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg418.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha418.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg419.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha419.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg420.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha420.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg421.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha421.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg422.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha422.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg423.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha423.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg424.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha424.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg425.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha425.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg426.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha426.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg427.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha427.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg428.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha428.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg429.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha429.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg430.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha430.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg431.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha431.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg432.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha432.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg433.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha433.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg434.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha434.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg435.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha435.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg436.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha436.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg437.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha437.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg438.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha438.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg439.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha439.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg440.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha440.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg441.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha441.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg442.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha442.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg443.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha443.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg444.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha444.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg445.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha445.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg446.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha446.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg447.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha447.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg448.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha448.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg449.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha449.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg450.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha450.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg451.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha451.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg452.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha452.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg453.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha453.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg454.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha454.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg455.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha455.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg456.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha456.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg457.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha457.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg458.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha458.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg459.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha459.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg460.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha460.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg461.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha461.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg462.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha462.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg463.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha463.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg464.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha464.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg465.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha465.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg466.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha466.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg467.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha467.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg468.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha468.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg469.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha469.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg470.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha470.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg471.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha471.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg472.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha472.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg473.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha473.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg474.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha474.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg475.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha475.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg476.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha476.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg477.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha477.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg478.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha478.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg479.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha479.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg480.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha480.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg481.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha481.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg482.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha482.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg483.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha483.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg484.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha484.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg485.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha485.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg486.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha486.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg487.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha487.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg488.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha488.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg489.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha489.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg490.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha490.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg491.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha491.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg492.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha492.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg493.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha493.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg494.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha494.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg495.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha495.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg496.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha496.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg497.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha497.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg498.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha498.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg499.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha499.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg500.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha500.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg501.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha501.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg502.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha502.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg503.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha503.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg504.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha504.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg505.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha505.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg506.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha506.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg507.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha507.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg508.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha508.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg509.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha509.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg510.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha510.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg511.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha511.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg512.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha512.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg513.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha513.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg514.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha514.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg515.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha515.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg516.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha516.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg517.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha517.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg518.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha518.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg519.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha519.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg520.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha520.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg521.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha521.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg522.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha522.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg523.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha523.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg524.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha524.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg525.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha525.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg526.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha526.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg527.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha527.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg528.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha528.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg529.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha529.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg530.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha530.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg531.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha531.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg532.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha532.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg533.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha533.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg534.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha534.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg535.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha535.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg536.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha536.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg537.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha537.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg538.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha538.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg539.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha539.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg540.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha540.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg541.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha541.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg542.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha542.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg543.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha543.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg544.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha544.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg545.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha545.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg546.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha546.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg547.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha547.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg548.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha548.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg549.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha549.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg550.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha550.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg551.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha551.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg552.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha552.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg553.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha553.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg554.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha554.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg555.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha555.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg556.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha556.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg557.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha557.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg558.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha558.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg559.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha559.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg560.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha560.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg561.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha561.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg562.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha562.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg563.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha563.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg564.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha564.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg565.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha565.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg566.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha566.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg567.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha567.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg568.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha568.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg569.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha569.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg570.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha570.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg571.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha571.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg572.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha572.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg573.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha573.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg574.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha574.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg575.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha575.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg576.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha576.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg577.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha577.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg578.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha578.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg579.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha579.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg580.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha580.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg581.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha581.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg582.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha582.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg583.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha583.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg584.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha584.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg585.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha585.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg586.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha586.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg587.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha587.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg588.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha588.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg589.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha589.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg590.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha590.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg591.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha591.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg592.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha592.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg593.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha593.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg594.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha594.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg595.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha595.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg596.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha596.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg597.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha597.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg598.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha598.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg599.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha599.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg600.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha600.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg601.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha601.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg602.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha602.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg603.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha603.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg604.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha604.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg605.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha605.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg606.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha606.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg607.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha607.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg608.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha608.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg609.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha609.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg610.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha610.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg611.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha611.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg612.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha612.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg613.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha613.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg614.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha614.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg615.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha615.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg616.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha616.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg617.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha617.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg618.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha618.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg619.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha619.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg620.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha620.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg621.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha621.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg622.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha622.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg623.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha623.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg624.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha624.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg625.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha625.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg626.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha626.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg627.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha627.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg628.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha628.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg629.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha629.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg630.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha630.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg631.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha631.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg632.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha632.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg633.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha633.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg634.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha634.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg635.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha635.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg636.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha636.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg637.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha637.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg638.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha638.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg639.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha639.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg640.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha640.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg641.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha641.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg642.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha642.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg643.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha643.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg644.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha644.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg645.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha645.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg646.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha646.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg647.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha647.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg648.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha648.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg649.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha649.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg650.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha650.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg651.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha651.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg652.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha652.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg653.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha653.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg654.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha654.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg655.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha655.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg656.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha656.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg657.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha657.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg658.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha658.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg659.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha659.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg660.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha660.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg661.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha661.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg662.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha662.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg663.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha663.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg664.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha664.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg665.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha665.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg666.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha666.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg667.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha667.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg668.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha668.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg669.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha669.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg670.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha670.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg671.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha671.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg672.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha672.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg673.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha673.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg674.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha674.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg675.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha675.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg676.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha676.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg677.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha677.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg678.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha678.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg679.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha679.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg680.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha680.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg681.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha681.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg682.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha682.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg683.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha683.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg684.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha684.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg685.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha685.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg686.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha686.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg687.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha687.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg688.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha688.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg689.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha689.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg690.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha690.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg691.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha691.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg692.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha692.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg693.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha693.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg694.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha694.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg695.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha695.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg696.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha696.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg697.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha697.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg698.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha698.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg699.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha699.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg700.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha700.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg701.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha701.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg702.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha702.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg703.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha703.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg704.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha704.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg705.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha705.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg706.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha706.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg707.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha707.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg708.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha708.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg709.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha709.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg710.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha710.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg711.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha711.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg712.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha712.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg713.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha713.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg714.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha714.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg715.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha715.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg716.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha716.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg717.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha717.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg718.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha718.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg719.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha719.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg720.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha720.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg721.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha721.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg722.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha722.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg723.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha723.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg724.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha724.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg725.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha725.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg726.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha726.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg727.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha727.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg728.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha728.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg729.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha729.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg730.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha730.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg731.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha731.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg732.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha732.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg733.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha733.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg734.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha734.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg735.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha735.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg736.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha736.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg737.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha737.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg738.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha738.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg739.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha739.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg740.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha740.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg741.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha741.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg742.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha742.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg743.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha743.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg744.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha744.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg745.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha745.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg746.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha746.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg747.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha747.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg748.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha748.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg749.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha749.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg750.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha750.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg751.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha751.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg752.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha752.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg753.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha753.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg754.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha754.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg755.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha755.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg756.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha756.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg757.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha757.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg758.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha758.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg759.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha759.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg760.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha760.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg761.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha761.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg762.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha762.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg763.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha763.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg764.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha764.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg765.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha765.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg766.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha766.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg767.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha767.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg768.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha768.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg769.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha769.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg770.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha770.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg771.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha771.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg772.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha772.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg773.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha773.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg774.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha774.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg775.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha775.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg776.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha776.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg777.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha777.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg778.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha778.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg779.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha779.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg780.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha780.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg781.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha781.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg782.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha782.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg783.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha783.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg784.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha784.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg785.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha785.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg786.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha786.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg787.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha787.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg788.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha788.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg789.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha789.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg790.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha790.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg791.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha791.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg792.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha792.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg793.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha793.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg794.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha794.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg795.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha795.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg796.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha796.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg797.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha797.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg798.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha798.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg799.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha799.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg800.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha800.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg801.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha801.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg802.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha802.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg803.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha803.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg804.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha804.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg805.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha805.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg806.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha806.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg807.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha807.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg808.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha808.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg809.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha809.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg810.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha810.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg811.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha811.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg812.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha812.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg813.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha813.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg814.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha814.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg815.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha815.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg816.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha816.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg817.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha817.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg818.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha818.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg819.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha819.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg820.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha820.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg821.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha821.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg822.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha822.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg823.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha823.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg824.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha824.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg825.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha825.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg826.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha826.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg827.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha827.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg828.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha828.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg829.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha829.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg830.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha830.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg831.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha831.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg832.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha832.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg833.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha833.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg834.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha834.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg835.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha835.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg836.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha836.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg837.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha837.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg838.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha838.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg839.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha839.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg840.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha840.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg841.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha841.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg842.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha842.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg843.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha843.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg844.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha844.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg845.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha845.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg846.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha846.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg847.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha847.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg848.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha848.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg849.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha849.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg850.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha850.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg851.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha851.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg852.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha852.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg853.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha853.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg854.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha854.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg855.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha855.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg856.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha856.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg857.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha857.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg858.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha858.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg859.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha859.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg860.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha860.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg861.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha861.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg862.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha862.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg863.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha863.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg864.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha864.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg865.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha865.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg866.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha866.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg867.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha867.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg868.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha868.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg869.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha869.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg870.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha870.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg871.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha871.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg872.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha872.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg873.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha873.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg874.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha874.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg875.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha875.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg876.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha876.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg877.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha877.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg878.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha878.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg879.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha879.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg880.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha880.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg881.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha881.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg882.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha882.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg883.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha883.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg884.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha884.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg885.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha885.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg886.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha886.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg887.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha887.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg888.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha888.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg889.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha889.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg890.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha890.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg891.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha891.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg892.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha892.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg893.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha893.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg894.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha894.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg895.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha895.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg896.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha896.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg897.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha897.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg898.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha898.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg899.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha899.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg900.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha900.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg901.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha901.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg902.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha902.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg903.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha903.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg904.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha904.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg905.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha905.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg906.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha906.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg907.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha907.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg908.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha908.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg909.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha909.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg910.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha910.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg911.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha911.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg912.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha912.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg913.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha913.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg914.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha914.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg915.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha915.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg916.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha916.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg917.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha917.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg918.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha918.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg919.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha919.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg920.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha920.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg921.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha921.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg922.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha922.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg923.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha923.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg924.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha924.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg925.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha925.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg926.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha926.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg927.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha927.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg928.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha928.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg929.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha929.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg930.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha930.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg931.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha931.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg932.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha932.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg933.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha933.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg934.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha934.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg935.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha935.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg936.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha936.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg937.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha937.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg938.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha938.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg939.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha939.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg940.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha940.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg941.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha941.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg942.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha942.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg943.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha943.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg944.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha944.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg945.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha945.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg946.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha946.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg947.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha947.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg948.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha948.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg949.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha949.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg950.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha950.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg951.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha951.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg952.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha952.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg953.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha953.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg954.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha954.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg955.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha955.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg956.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha956.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg957.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha957.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg958.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha958.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg959.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha959.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg960.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha960.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg961.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha961.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg962.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha962.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg963.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha963.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg964.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha964.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg965.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha965.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg966.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha966.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg967.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha967.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg968.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha968.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg969.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha969.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg970.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha970.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg971.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha971.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg972.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha972.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg973.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha973.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg974.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha974.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg975.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha975.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg976.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha976.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg977.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha977.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg978.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha978.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg979.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha979.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg980.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha980.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg981.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha981.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg982.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha982.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg983.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha983.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg984.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha984.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg985.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha985.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg986.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha986.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg987.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha987.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg988.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha988.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg989.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha989.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg990.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha990.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg991.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha991.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg992.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha992.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg993.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha993.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg994.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha994.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg995.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha995.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg996.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha996.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg997.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha997.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg998.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha998.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg999.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha999.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1000.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1000.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1001.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1001.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1002.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1002.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1003.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1003.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1004.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1004.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1005.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1005.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1006.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1006.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1007.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1007.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1008.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1008.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1009.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1009.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1010.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1010.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1011.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1011.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1012.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1012.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1013.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1013.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1014.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1014.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1015.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1015.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1016.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1016.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1017.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1017.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1018.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1018.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1019.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1019.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1020.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1020.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1021.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1021.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1022.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1022.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1023.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1023.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1024.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1024.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1025.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1025.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1026.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1026.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1027.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1027.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1028.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1028.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1029.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1029.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1030.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1030.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1031.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1031.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1032.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1032.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1033.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1033.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1034.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1034.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1035.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1035.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1036.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1036.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1037.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1037.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1038.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1038.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1039.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1039.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1040.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1040.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1041.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1041.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1042.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1042.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1043.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1043.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1044.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1044.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1045.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1045.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1046.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1046.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1047.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1047.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1048.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1048.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1049.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1049.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1050.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1050.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1051.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1051.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1052.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1052.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1053.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1053.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1054.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1054.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1055.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1055.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1056.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1056.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1057.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1057.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1058.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1058.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1059.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1059.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1060.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1060.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1061.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1061.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1062.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1062.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1063.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1063.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1064.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1064.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1065.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1065.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1066.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1066.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1067.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1067.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1068.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1068.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1069.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1069.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1070.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1070.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1071.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1071.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1072.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1072.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1073.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1073.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1074.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1074.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1075.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1075.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1076.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1076.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1077.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1077.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1078.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1078.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1079.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1079.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1080.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1080.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1081.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1081.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1082.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1082.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1083.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1083.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1084.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1084.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1085.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1085.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1086.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1086.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1087.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1087.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1088.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1088.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1089.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1089.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1090.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1090.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1091.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1091.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1092.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1092.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1093.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1093.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1094.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1094.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1095.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1095.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1096.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1096.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1097.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1097.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1098.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1098.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1099.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1099.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1100.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1100.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1101.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1101.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1102.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1102.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1103.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1103.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1104.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1104.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1105.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1105.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1106.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1106.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1107.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1107.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1108.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1108.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1109.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1109.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1110.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1110.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1111.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1111.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1112.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1112.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1113.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1113.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1114.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1114.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1115.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1115.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1116.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1116.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1117.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1117.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1118.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1118.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1119.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1119.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1120.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1120.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1121.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1121.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1122.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1122.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1123.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1123.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1124.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1124.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1125.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1125.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1126.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1126.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1127.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1127.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1128.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1128.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1129.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1129.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1130.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1130.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1131.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1131.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1132.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1132.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1133.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1133.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1134.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1134.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1135.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1135.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1136.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1136.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1137.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1137.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1138.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1138.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1139.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1139.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1140.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1140.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1141.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1141.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1142.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1142.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1143.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1143.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1144.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1144.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1145.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1145.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1146.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1146.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1147.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1147.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1148.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1148.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1149.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1149.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1150.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1150.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1151.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1151.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1152.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1152.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1153.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1153.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1154.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1154.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1155.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1155.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1156.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1156.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1157.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1157.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1158.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1158.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1159.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1159.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1160.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1160.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1161.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1161.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1162.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1162.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1163.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1163.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1164.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1164.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1165.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1165.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1166.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1166.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1167.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1167.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1168.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1168.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1169.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1169.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1170.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1170.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1171.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1171.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1172.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1172.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1173.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1173.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1174.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1174.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1175.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1175.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1176.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1176.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1177.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1177.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1178.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1178.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1179.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1179.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1180.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1180.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1181.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1181.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1182.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1182.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1183.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1183.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1184.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1184.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1185.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1185.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1186.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1186.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1187.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1187.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1188.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1188.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1189.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1189.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1190.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1190.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1191.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1191.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1192.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1192.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1193.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1193.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1194.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1194.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1195.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1195.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1196.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1196.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1197.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1197.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1198.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1198.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1199.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1199.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1200.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1200.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1201.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1201.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1202.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1202.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1203.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1203.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1204.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1204.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1205.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1205.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1206.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1206.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1207.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1207.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1208.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1208.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1209.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1209.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1210.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1210.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1211.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1211.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1212.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1212.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1213.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1213.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1214.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1214.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1215.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1215.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1216.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1216.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1217.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1217.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1218.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1218.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1219.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1219.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1220.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1220.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1221.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1221.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1222.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1222.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1223.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1223.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1224.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1224.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1225.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1225.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1226.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1226.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1227.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1227.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1228.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1228.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1229.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1229.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1230.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1230.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1231.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1231.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1232.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1232.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1233.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1233.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1234.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1234.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1235.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1235.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1236.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1236.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1237.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1237.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1238.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1238.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1239.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1239.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1240.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1240.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1241.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1241.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1242.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1242.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1243.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1243.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1244.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1244.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1245.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1245.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1246.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1246.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1247.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1247.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1248.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1248.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1249.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1249.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1250.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1250.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1251.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1251.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1252.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1252.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1253.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1253.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1254.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1254.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1255.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1255.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1256.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1256.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1257.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1257.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1258.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1258.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1259.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1259.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1260.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1260.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1261.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1261.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1262.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1262.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1263.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1263.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1264.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1264.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1265.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1265.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1266.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1266.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1267.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1267.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1268.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1268.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1269.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1269.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1270.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1270.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1271.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1271.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1272.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1272.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1273.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1273.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1274.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1274.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1275.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1275.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1276.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1276.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1277.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1277.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1278.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1278.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1279.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1279.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1280.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1280.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1281.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1281.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1282.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1282.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1283.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1283.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1284.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1284.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1285.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1285.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1286.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1286.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1287.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1287.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1288.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1288.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1289.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1289.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1290.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1290.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1291.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1291.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1292.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1292.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1293.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1293.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1294.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1294.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1295.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1295.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1296.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1296.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1297.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1297.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1298.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1298.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1299.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1299.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1300.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1300.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1301.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1301.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1302.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1302.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1303.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1303.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1304.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1304.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1305.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1305.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1306.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1306.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1307.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1307.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1308.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1308.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1309.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1309.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1310.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1310.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1311.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1311.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1312.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1312.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1313.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1313.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1314.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1314.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1315.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1315.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1316.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1316.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1317.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1317.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1318.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1318.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1319.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1319.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1320.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1320.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1321.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1321.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1322.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1322.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1323.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1323.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1324.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1324.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1325.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1325.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1326.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1326.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1327.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1327.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1328.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1328.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1329.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1329.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1330.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1330.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1331.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1331.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1332.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1332.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1333.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1333.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1334.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1334.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1335.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1335.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1336.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1336.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1337.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1337.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1338.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1338.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1339.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1339.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1340.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1340.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1341.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1341.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1342.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1342.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1343.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1343.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1344.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1344.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1345.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1345.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1346.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1346.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1347.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1347.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1348.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1348.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1349.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1349.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1350.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1350.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1351.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1351.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1352.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1352.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1353.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1353.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1354.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1354.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1355.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1355.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1356.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1356.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1357.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1357.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1358.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1358.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1359.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1359.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1360.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1360.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1361.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1361.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1362.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1362.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1363.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1363.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1364.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1364.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1365.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1365.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1366.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1366.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1367.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1367.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1368.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1368.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1369.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1369.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1370.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1370.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1371.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1371.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1372.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1372.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1373.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1373.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1374.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1374.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1375.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1375.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1376.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1376.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1377.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1377.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1378.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1378.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1379.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1379.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1380.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1380.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1381.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1381.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1382.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1382.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1383.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1383.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1384.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1384.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1385.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1385.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1386.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1386.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1387.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1387.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1388.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1388.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1389.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1389.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1390.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1390.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1391.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1391.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1392.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1392.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1393.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1393.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1394.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1394.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1395.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1395.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1396.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1396.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1397.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1397.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1398.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1398.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1399.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1399.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1400.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1400.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1401.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1401.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1402.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1402.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1403.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1403.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1404.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1404.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1405.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1405.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1406.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1406.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1407.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1407.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1408.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1408.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1409.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1409.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1410.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1410.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1411.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1411.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1412.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1412.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1413.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1413.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1414.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1414.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1415.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1415.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1416.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1416.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1417.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1417.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1418.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1418.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1419.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1419.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1420.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1420.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1421.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1421.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1422.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1422.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1423.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1423.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1424.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1424.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1425.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1425.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1426.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1426.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1427.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1427.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1428.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1428.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1429.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1429.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1430.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1430.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1431.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1431.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1432.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1432.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1433.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1433.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1434.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1434.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1435.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1435.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1436.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1436.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1437.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1437.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1438.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1438.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1439.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1439.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1440.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1440.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1441.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1441.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1442.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1442.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1443.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1443.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1444.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1444.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1445.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1445.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1446.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1446.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1447.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1447.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1448.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1448.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1449.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1449.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1450.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1450.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1451.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1451.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1452.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1452.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1453.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1453.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1454.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1454.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1455.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1455.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1456.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1456.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1457.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1457.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1458.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1458.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1459.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1459.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1460.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1460.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1461.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1461.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1462.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1462.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1463.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1463.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1464.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1464.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1465.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1465.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1466.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1466.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1467.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1467.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1468.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1468.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1469.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1469.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1470.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1470.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1471.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1471.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1472.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1472.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1473.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1473.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1474.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1474.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1475.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1475.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1476.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1476.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1477.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1477.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1478.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1478.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1479.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1479.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1480.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1480.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1481.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1481.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1482.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1482.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1483.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1483.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1484.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1484.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1485.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1485.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1486.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1486.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1487.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1487.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1488.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1488.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1489.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1489.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1490.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1490.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1491.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1491.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1492.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1492.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1493.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1493.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1494.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1494.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1495.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1495.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1496.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1496.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1497.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1497.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1498.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1498.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1499.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1499.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1500.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1500.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1501.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1501.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1502.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1502.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1503.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1503.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1504.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1504.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1505.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1505.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1506.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1506.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1507.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1507.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1508.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1508.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1509.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1509.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1510.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1510.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1511.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1511.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1512.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1512.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1513.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1513.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1514.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1514.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1515.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1515.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1516.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1516.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1517.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1517.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1518.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1518.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1519.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1519.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1520.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1520.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1521.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1521.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1522.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1522.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1523.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1523.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1524.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1524.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1525.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1525.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1526.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1526.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1527.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1527.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1528.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1528.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1529.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1529.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1530.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1530.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1531.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1531.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1532.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1532.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1533.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1533.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1534.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1534.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1535.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1535.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1536.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1536.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1537.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1537.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1538.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1538.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1539.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1539.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1540.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1540.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1541.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1541.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1542.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1542.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1543.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1543.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1544.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1544.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1545.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1545.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1546.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1546.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1547.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1547.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1548.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1548.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1549.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1549.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1550.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1550.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1551.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1551.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1552.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1552.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1553.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1553.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1554.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1554.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1555.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1555.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1556.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1556.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1557.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1557.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1558.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1558.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1559.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1559.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1560.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1560.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1561.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1561.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1562.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1562.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1563.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1563.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;


DROP TABLE IF EXISTS tmp_vg_import;
CREATE TEMP TABLE tmp_vg_import (date_hour timestamptz
		,grupo TEXT
		,arl INTEGER
		,estado_ope TEXT
		,pi_sotr NUMERIC
		,arl_econ INTEGER
		,est_remun TEXT
		,energia NUMERIC
		,precio_nodo NUMERIC
		,pr_rem_energia NUMERIC
		,smec TEXT
		,pot_disp NUMERIC
		,pot_ope_cpo NUMERIC
		,compra_spot NUMERIC
		,sctd NUMERIC
		,sco NUMERIC
		,pind NUMERIC
		,pindprog NUMERIC
		,pindforz NUMERIC
		,pot_disp_gas NUMERIC
		,pot_disp_reserva NUMERIC
		,gas_nominado NUMERIC
		,"costo_406" NUMERIC
		,rem_adicional NUMERIC
		,desp_econ TEXT
		,ccm NUMERIC
		,cfo NUMERIC
		,cgn NUMERIC
		,cgo NUMERIC
		,"pot_disp_r19" NUMERIC
		,factor_km NUMERIC
		,date text
		,hour integer); 

COPY tmp_vg_import (
		grupo
		,hour
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km )
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\vg1564.csv'
DELIMITER ',' NULL AS '';

COPY tmp_vg_import ("date")
FROM 'C:\Users\Administrador\Desktop\PO historico\csv\fecha1564.csv'
DELIMITER ',';

UPDATE tmp_vg_import SET date = datefix.date FROM (SELECT date FROM tmp_vg_import WHERE grupo IS NULL) as datefix;
ALTER TABLE tmp_vg_import ALTER COLUMN date TYPE timestamptz USING to_timestamp(date, 'YYYY-MM-DD hh24:mi:ss');
DELETE FROM tmp_vg_import WHERE grupo IS NULL;

UPDATE tmp_vg_import
SET date_hour = datefix.date2
FROM (
	SELECT grupo
		,hour
		,compra_spot
		,DATE + interval '1 hour' * "hour" AS date2
	FROM tmp_vg_import
	) AS datefix
WHERE datefix.hour = tmp_vg_import.hour
	AND datefix.grupo = tmp_vg_import.grupo;
	
ALTER TABLE tmp_vg_import DROP COLUMN date, DROP COLUMN hour;
INSERT INTO smec.valores_generadores SELECT date_hour 
		,grupo 
		,arl 
		,estado_ope 
		,pi_sotr 
		,arl_econ 
		,est_remun 
		,energia 
		,precio_nodo 
		,pr_rem_energia 
		,smec 
		,pot_disp 
		,pot_ope_cpo 
		,compra_spot 
		,sctd 
		,sco 
		,pind 
		,pindprog 
		,pindforz 
		,pot_disp_gas 
		,pot_disp_reserva 
		,gas_nominado 
		,"costo_406" 
		,rem_adicional 
		,desp_econ 
		,ccm 
		,cfo 
		,cgn 
		,cgo 
		,"pot_disp_r19" 
		,factor_km 
		FROM tmp_vg_import ON CONFLICT DO NOTHING;
